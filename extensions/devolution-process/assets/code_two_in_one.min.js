document.addEventListener("DOMContentLoaded",e=>{let t=document.querySelector(".user-choose"),n=document.querySelector(".devolution-process-section"),s=document.querySelector(".main-section-container"),o=document.getElementById("check_button_opt"),r=document.getElementById("create_button_opt");o.addEventListener("click",()=>{t.style.display="none",s.style.display="flex"}),r.addEventListener("click",()=>{t.style.display="none",n.style.display="flex"});let i={};function a(){let e=document.getElementById("progress-bar"),t=document.querySelector(".pending__svg"),n=document.querySelector(".carrier__svg"),s=document.querySelector(".review__svg"),o=document.querySelector(".result__svg");e.style.width="0%",t.classList.contains("done")&&t.classList.remove("done"),n.classList.contains("done")&&n.classList.remove("done"),s.classList.contains("done")&&s.classList.remove("done"),o.classList.contains("done")&&(o.classList.remove("done"),o.innerHTML="")}function l(){let e=document.getElementById("progress-bar"),t=document.querySelector(".pending__svg"),n=document.querySelector(".carrier__svg"),s=document.querySelector(".review__svg"),o=document.querySelector(".result__svg");console.log(i.status),"Pendiente"==i.status?(e.style.width="0%",t.classList.add("done")):"En camino"==i.status?(e.style.width="33%",t.classList.add("done"),n.classList.add("done")):"En revision"==i.status?(e.style.width="68%",t.classList.add("done"),n.classList.add("done"),s.classList.add("done")):"Rechazado"==i.status?(e.style.width="100%",t.classList.add("done"),n.classList.add("done"),s.classList.add("done"),o.classList.add("done"),o.innerHTML='<svg viewBox="0 -0.5 8 8" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" fill="#000000"><g id="SVGRepo_bgCarrier" stroke-width="0"></g><g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g><g id="SVGRepo_iconCarrier"> <title>close_mini [#1522]</title> <desc>Created with Sketch.</desc> <defs> </defs> <g id="Page-1" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"> <g id="Dribbble-Light-Preview" transform="translate(-385.000000, -206.000000)" fill="#000000"> <g id="icons" transform="translate(56.000000, 160.000000)"> <polygon id="close_mini-[#1522]" points="334.6 49.5 337 51.6 335.4 53 333 50.9 330.6 53 329 51.6 331.4 49.5 329 47.4 330.6 46 333 48.1 335.4 46 337 47.4"> </polygon> </g> </g> </g> </g></svg>'):"Aceptado"==i.status&&(e.style.width="100%",t.classList.add("done"),n.classList.add("done"),s.classList.add("done"),o.classList.add("done"),o.innerHTML='<svg viewBox="0 -1.5 11 11" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" fill="#000000"><g id="SVGRepo_bgCarrier" stroke-width="0"></g><g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g><g id="SVGRepo_iconCarrier"> <title>done_mini [#1484]</title> <desc>Created with Sketch.</desc> <defs> </defs> <g id="Page-1" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"> <g id="Dribbble-Light-Preview" transform="translate(-304.000000, -366.000000)" fill="#000000"> <g id="icons" transform="translate(56.000000, 160.000000)"> <polygon id="done_mini-[#1484]" points="259 207.6 252.2317 214 252.2306 213.999 252.2306 214 248 210 249.6918 208.4 252.2306 210.8 257.3082 206"> </polygon> </g> </g> </g> </g></svg>'),console.log("Hola")}async function d(e){a();try{let t=window.location.origin+"/apps/store-return/?id="+e,n=await fetch(t);if(!n.ok)throw Error(`HTTP error! status: ${n.status}`);let s=await n.json();return console.log("Success:",s.devolution),s.devolution}catch(o){return console.error("Error:",o),null}}async function c(){let e=document.getElementById("search-input").value,t=await d(e);""!=e&&null!=t?(i=t,g(),l(),u("result")):u("no-result")}function u(e){let t=document.querySelector(".no-result-found"),n=document.querySelector(".result-container");"result"==e?(n.classList.contains("show")||n.classList.add("show"),t.classList.contains("show")&&t.classList.remove("show")):"no-result"==e&&(t.classList.contains("show")||t.classList.add("show"),n.classList.contains("show")&&n.classList.remove("show"))}function g(){let e=document.getElementById("status-info-label"),t=document.getElementById("status-info-populated"),n=document.getElementById("status-info-commentaries");"Pendiente"==i.status?(e.innerHTML="Pendiente",t.innerHTML="Tu devoluci\xf3n ha sido registrada y se encuentra en proceso de verficaci\xf3n"):"En camino"==i.status?(e.innerHTML="En camino",t.innerHTML="Tu devoluci\xf3n ha pasado el primer filtro y se encuentra en camino a nuestras instalaciones"):"En revision"==i.status?(e.innerHTML="En revision",t.innerHTML="Tu devoluci\xf3n ha llegado a nuestras instalaciones y se encuentra en proceso de revisi\xf3n"):"Rechazado"==i.status?(e.innerHTML="Rechazado",t.innerHTML="Tu devoluci\xf3n ha sido rechazada",n.innerHTML=i.comentarios):"Aceptado"==i.status&&(e.innerHTML="Aceptado",t.innerHTML="Tu devoluci\xf3n ha sido aceptada",""!=i.ndc&""==i.monedero?n.innerHTML=`Tienes una nota de credito <strong class="important-text">#${i.ndc}</strong> con valor de <strong class="important-text">$ ${i.value}</strong>`:""!=i.monedero&""==i.ndc&&(n.innerHTML=`Tienes un monedero <strong class="important-text">#${i.ndc}</strong> con valor de <strong class="important-text">$ ${i.value}</strong>`))}let m=document.getElementById("search-button");m.addEventListener("click",c);let $={subsidiary:"",main_reason:"",explanation:"",ticket_number:"",client_number:"",order_number:"",items:[],date_product_arrived:"",phone_number:""};function y(e,t){return""!==e||(alert(`El campo ${t} es obligatorio.`),!1)}function p(){$.subsidiary="",$.main_reason="",$.explanation="",$.ticket_number="",$.client_number="",$.order_number="",$.items=[],$.date_product_arrived="",$.phone_number="",document.getElementById("ticket-input").value="",document.getElementById("order-input").value="",document.getElementById("client-number").value="",document.getElementById("reason-input").value="",document.getElementById("subsidiary-input").value="",document.getElementById("commentaries").value="",document.getElementById("date-input").value="",document.getElementById("sku-input").value="",document.getElementById("qty-input").value="",document.getElementById("phone-number").value="";let e=document.querySelector("#product-table tbody");e.innerHTML=""}function v(e,t){document.getElementById(`card-${e}`).classList.remove("show-card"),document.getElementById(`card-${t}`)&&document.getElementById(`card-${t}`).classList.add("show-card")}function h(e){let t=parseInt(e)-1;document.getElementById(`card-${e}`).classList.remove("show-card"),document.getElementById(`card-${t}`)&&document.getElementById(`card-${t}`).classList.add("show-card")}function L(e){p();let t=document.getElementById("folio-number");t.innerHTML=e.id;let n=document.getElementById("whatsapp-anchor"),s=`https://api.whatsapp.com/send?phone=522211939333&text=Hola, genere un nuevo ticket, por *${e.mainReason}*. Mi n\xfamero de folio es *${e.id}*.`;n.href=s,v(9,10)}function E(){document.querySelector(".sucess-info").classList.contains("show-result-info")&&document.querySelector(".sucess-info").classList.remove("show-result-info"),document.querySelector(".error-info").classList.contains("show-result-info")&&document.querySelector(".error-info").classList.remove("show-result-info");let e=window.location.origin+"/apps/store-return/";document.getElementById("loading-spinner").style.display="block",fetch(e,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify($)}).then(e=>e.json()).then(e=>{document.getElementById("loading-spinner").style.display="none",document.querySelector(".sucess-info").classList.add("show-result-info"),L(e.devolution)}).catch(e=>{console.error("Error:",e),document.getElementById("loading-spinner").style.display="none",document.querySelector(".error-info").classList.add("show-result-info"),v(9,10)})}let f=document.querySelectorAll(".card"),w=document.querySelectorAll("#next-card"),b=document.querySelectorAll("#previus-card");function k(){return!($.items.length<=0)||(alert(`No has agregado ningun item para garant\xeda`),!1)}f[0].classList.add("show-card"),w.forEach(e=>{e.addEventListener("click",function(){let e=this.getAttribute("data-card"),t=parseInt(e)+1;switch(e){case"1":let n=document.getElementById("ticket-input").value;y(n,"N\xfamero de Ticket")&&($.ticket_number=n,v(e,t));break;case"2":$.order_number=document.getElementById("order-input").value,v(e,t);break;case"3":let s=document.getElementById("client-number").value;y(s,"N\xfamero de Cliente")&&($.client_number=s,v(e,t));break;case"4":let o=document.getElementById("reason-input").value;y(o,"Motivo de Devoluci\xf3n")&&($.main_reason=o,v(e,t));break;case"5":let r=document.getElementById("subsidiary-input").value;y(r,"Lugar de Compra")&&($.subsidiary=r,v(e,t));break;case"6":$.explanation=document.getElementById("commentaries").value,v(e,t);break;case"7":let i=document.getElementById("date-input").value;y(i,"Fecha de Recepci\xf3n del Producto")&&($.date_product_arrived=i+" 00:00:00.000",v(e,t));break;case"8":k()&&v(e,t);break;case"9":let a=document.getElementById("phone-number").value;y(a,"N\xfamero de Tel\xe9fono")&&($.phone_number=a,E())}})}),b.forEach(e=>{e.addEventListener("click",function(){let e=this.getAttribute("data-card");h(e)})});let B=document.getElementById("add-product-button"),_=document.getElementById("sku-input"),I=document.getElementById("qty-input"),S=document.querySelector("#product-table tbody");B.addEventListener("click",()=>{let e=_.value,t=Number(I.value);if(y(e,"SKU")&&y(t,"Cantidad")){console.log($.items);let n=$.items.findIndex(t=>t.sku==e);if(-1!=n){$.items[n].cantidad+=t;let s=S.getElementsByTagName("tr");for(let o of s){let r=o.getElementsByTagName("td")[0];if(r.textContent==e){let i=o.getElementsByTagName("td")[1];i.textContent=$.items[n].cantidad;break}}console.log(n)}else{console.log(n),$.items.push({sku:e,cantidad:t});let a=document.createElement("tr"),l=document.createElement("td");l.textContent=e;let d=document.createElement("td");d.textContent=t,a.appendChild(l),a.appendChild(d),S.appendChild(a),_.value="",I.value=""}}});let T=document.querySelectorAll(".tooltip");T.forEach(e=>{e.addEventListener("click",()=>{let t=e.querySelector(".tooltiptext");t.classList.contains("show-tooltip")?t.classList.remove("show-tooltip"):t.classList.add("show-tooltip")})})});