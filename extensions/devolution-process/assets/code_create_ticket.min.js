document.addEventListener("DOMContentLoaded",e=>{let t={subsidiary:"",main_reason:"",explanation:"",ticket_number:"",client_number:"",order_number:"",items:[],date_product_arrived:"",phone_number:""};function n(e,t){return""!==e||(alert(`El campo ${t} es obligatorio.`),!1)}function l(){t.subsidiary="",t.main_reason="",t.explanation="",t.ticket_number="",t.client_number="",t.order_number="",t.items=[],t.date_product_arrived="",t.phone_number="",document.getElementById("ticket-input").value="",document.getElementById("order-input").value="",document.getElementById("client-number").value="",document.getElementById("reason-input").value="",document.getElementById("subsidiary-input").value="",document.getElementById("commentaries").value="",document.getElementById("date-input").value="",document.getElementById("sku-input").value="",document.getElementById("qty-input").value="",document.getElementById("phone-number").value="";let e=document.querySelector("#product-table tbody");e.innerHTML=""}function a(e,t){document.getElementById(`card-${e}`).classList.remove("show"),document.getElementById(`card-${t}`)&&document.getElementById(`card-${t}`).classList.add("show")}function r(e){let t=parseInt(e)-1;document.getElementById(`card-${e}`).classList.remove("show"),document.getElementById(`card-${t}`)&&document.getElementById(`card-${t}`).classList.add("show")}function o(e){console.log(e),l();let t=document.getElementById("folio-number");t.innerHTML=e.id;let n=document.getElementById("whatsapp-anchor"),r=`https://api.whatsapp.com/send?phone=522211939333&text=Hola, genere un nuevo ticket, por *${e.mainReason}* y mi compra la realice en *PT${e.sucursal}*. Mi n\xfamero de folio es *${e.id}*.`;n.href=r,a(9,10)}function i(){document.querySelector(".sucess-info").classList.contains("show-result-info")&&document.querySelector(".sucess-info").classList.remove("show-result-info"),document.querySelector(".error-info").classList.contains("show-result-info")&&document.querySelector(".error-info").classList.remove("show-result-info");let e=window.location.origin+"/apps/store-return/";document.getElementById("loading-spinner").style.display="block",fetch(e,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)}).then(e=>e.json()).then(e=>{document.getElementById("loading-spinner").style.display="none",document.querySelector(".sucess-info").classList.add("show-result-info"),o(e.devolution)}).catch(e=>{console.error("Error:",e),document.getElementById("loading-spinner").style.display="none",document.querySelector(".error-info").classList.add("show-result-info"),a(9,10)})}let s=document.querySelectorAll(".card"),d=document.querySelectorAll("#next-card"),c=document.querySelectorAll("#previus-card");function u(){return!(t.items.length<=0)||(alert(`No has agregado ningun item para garant\xeda`),!1)}s[0].classList.add("show"),d.forEach(e=>{e.addEventListener("click",function(){let e=this.getAttribute("data-card"),l=parseInt(e)+1;switch(e){case"1":let r=document.getElementById("ticket-input").value;n(r,"N\xfamero de Ticket")&&(t.ticket_number=r,a(e,l));break;case"2":t.order_number=document.getElementById("order-input").value,a(e,l);break;case"3":let o=document.getElementById("client-number").value;n(o,"N\xfamero de Cliente")&&(t.client_number=o,a(e,l));break;case"4":let s=document.getElementById("reason-input").value;n(s,"Motivo de Devoluci\xf3n")&&(t.main_reason=s,a(e,l));break;case"5":let d=document.getElementById("subsidiary-input").value;n(d,"Lugar de Compra")&&(t.subsidiary=d,a(e,l));break;case"6":t.explanation=document.getElementById("commentaries").value,a(e,l);break;case"7":let c=document.getElementById("date-input").value;n(c,"Fecha de Recepci\xf3n del Producto")&&(t.date_product_arrived=c+" 00:00:00.000",a(e,l));break;case"8":u()&&a(e,l);break;case"9":let m=document.getElementById("phone-number").value;n(m,"N\xfamero de Tel\xe9fono")&&(t.phone_number=m,i())}})}),c.forEach(e=>{e.addEventListener("click",function(){let e=this.getAttribute("data-card");r(e)})});let m=document.getElementById("add-product-button"),y=document.getElementById("sku-input"),p=document.getElementById("qty-input"),g=document.querySelector("#product-table tbody");m.addEventListener("click",()=>{let e=y.value,l=Number(p.value);if(n(e,"SKU")&&n(l,"Cantidad")){console.log(t.items);let a=t.items.findIndex(t=>t.sku==e);if(-1!=a){t.items[a].cantidad+=l;let r=g.getElementsByTagName("tr");for(let o of r){let i=o.getElementsByTagName("td")[0];if(i.textContent==e){let s=o.getElementsByTagName("td")[1];s.textContent=t.items[a].cantidad;break}}console.log(a)}else{console.log(a),t.items.push({sku:e,cantidad:l});let d=document.createElement("tr"),c=document.createElement("td");c.textContent=e;let u=document.createElement("td");u.textContent=l,d.appendChild(c),d.appendChild(u),g.appendChild(d),y.value="",p.value=""}}});let E=document.querySelectorAll(".tooltip");E.forEach(e=>{e.addEventListener("click",()=>{let t=e.querySelector(".tooltiptext");t.classList.contains("show-tooltip")?t.classList.remove("show-tooltip"):t.classList.add("show-tooltip")})})});